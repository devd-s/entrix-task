{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.204.0"},"children":{"EntrixEnergyAuctionStack-dev":{"id":"EntrixEnergyAuctionStack-dev","path":"EntrixEnergyAuctionStack-dev","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.204.0"},"children":{"OrderResultsBucket":{"id":"OrderResultsBucket","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":{"Fn::Join":["",["entrix-order-results-dev-",{"Ref":"AWS::AccountId"}]]},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"OrderResultsBucket35E2B63A"},"policyDocument":{"Statement":[{"Action":["s3:DeleteObject*","s3:GetBucket*","s3:List*","s3:PutBucketPolicy"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["OrderResultsBucket35E2B63A","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["OrderResultsBucket35E2B63A","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.204.0","metadata":[]},"children":{"Default":{"id":"Default","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"EntrixEnergyAuctionStack-dev/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.204.0"},"children":{"Staging":{"id":"Staging","path":"EntrixEnergyAuctionStack-dev/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"Role":{"id":"Role","path":"EntrixEnergyAuctionStack-dev/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}},"Handler":{"id":"Handler","path":"EntrixEnergyAuctionStack-dev/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}}}},"OrdersTable":{"id":"OrdersTable","path":"EntrixEnergyAuctionStack-dev/OrdersTable","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.Table","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/OrdersTable/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_dynamodb.CfnTable","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::DynamoDB::Table","aws:cdk:cloudformation:props":{"attributeDefinitions":[{"attributeName":"record_id","attributeType":"S"}],"billingMode":"PAY_PER_REQUEST","keySchema":[{"attributeName":"record_id","keyType":"HASH"}],"tableName":"entrix-orders-dev","timeToLiveSpecification":{"attributeName":"ttl","enabled":true}}}},"ScalingRole":{"id":"ScalingRole","path":"EntrixEnergyAuctionStack-dev/OrdersTable/ScalingRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}}}},"ErrorNotificationTopic":{"id":"ErrorNotificationTopic","path":"EntrixEnergyAuctionStack-dev/ErrorNotificationTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/ErrorNotificationTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Error Notifications for Energy Auction Issues","topicName":"error-notifications-dev"}}},"devops-team@company.com":{"id":"devops-team@company.com","path":"EntrixEnergyAuctionStack-dev/ErrorNotificationTopic/devops-team@company.com","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/ErrorNotificationTopic/devops-team@company.com/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":"devops-team@company.com","protocol":"email","topicArn":{"Ref":"ErrorNotificationTopic0DACB6F3"}}}}}}}},"EntrixPostLambda":{"id":"EntrixPostLambda","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["dynamodb:BatchGetItem","dynamodb:BatchWriteItem","dynamodb:ConditionCheckItem","dynamodb:DeleteItem","dynamodb:DescribeTable","dynamodb:GetItem","dynamodb:GetRecords","dynamodb:GetShardIterator","dynamodb:PutItem","dynamodb:Query","dynamodb:Scan","dynamodb:UpdateItem"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["OrdersTable315BB997","Arn"]},{"Ref":"AWS::NoValue"}]}],"Version":"2012-10-17"},"policyName":"EntrixPostLambdaServiceRoleDefaultPolicy6FF0B3FC","roles":[{"Ref":"EntrixPostLambdaServiceRoleB775C877"}]}}}}}}},"Code":{"id":"Code","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EntrixPostLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-844682013548-eu-west-1","s3Key":"80fa0d4324672b78795ef93afd3e285b10fc25af2b1fce33f72b00891ea0f29d.zip"},"environment":{"variables":{"TABLE_NAME":{"Ref":"OrdersTable315BB997"},"DYNAMODB_FLOAT_SERIALIZER":"use_decimal"}},"handler":"app.lambda_handler","role":{"Fn::GetAtt":["EntrixPostLambdaServiceRoleB775C877","Arn"]},"runtime":"python3.9","timeout":30}}}}},"LambdaA":{"id":"LambdaA","path":"EntrixEnergyAuctionStack-dev/LambdaA","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"EntrixEnergyAuctionStack-dev/LambdaA/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"EntrixEnergyAuctionStack-dev/LambdaA/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/LambdaA/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Code":{"id":"Code","path":"EntrixEnergyAuctionStack-dev/LambdaA/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"EntrixEnergyAuctionStack-dev/LambdaA/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"EntrixEnergyAuctionStack-dev/LambdaA/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/LambdaA/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-844682013548-eu-west-1","s3Key":"3f7f6036e4da3bebf9ad731eda4ef80c26f7103aba18080076b49f568181686d.zip"},"handler":"app.lambda_handler","role":{"Fn::GetAtt":["LambdaAServiceRole22081E46","Arn"]},"runtime":"python3.9","timeout":30}}}}},"LambdaB":{"id":"LambdaB","path":"EntrixEnergyAuctionStack-dev/LambdaB","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"EntrixEnergyAuctionStack-dev/LambdaB/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"EntrixEnergyAuctionStack-dev/LambdaB/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/LambdaB/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/LambdaB/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/LambdaB/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["OrderResultsBucket35E2B63A","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["OrderResultsBucket35E2B63A","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"LambdaBServiceRoleDefaultPolicy42ED4EA2","roles":[{"Ref":"LambdaBServiceRole054CD0BC"}]}}}}}}},"Code":{"id":"Code","path":"EntrixEnergyAuctionStack-dev/LambdaB/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.204.0"},"children":{"Stage":{"id":"Stage","path":"EntrixEnergyAuctionStack-dev/LambdaB/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.204.0"}},"AssetBucket":{"id":"AssetBucket","path":"EntrixEnergyAuctionStack-dev/LambdaB/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.204.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/LambdaB/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":"cdk-hnb659fds-assets-844682013548-eu-west-1","s3Key":"ea9355f5fdc02d8ba30b3d89d63859ff1b7fd964e77e9874571a0a080133ddba.zip"},"environment":{"variables":{"LOG_BUCKET":{"Ref":"OrderResultsBucket35E2B63A"}}},"handler":"app.lambda_handler","role":{"Fn::GetAtt":["LambdaBServiceRole054CD0BC","Arn"]},"runtime":"python3.9","timeout":30}}}}},"SlackNotificationLambda":{"id":"SlackNotificationLambda","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.204.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nimport json\nimport urllib3\nimport os\n\ndef lambda_handler(event, context):\n    \"\"\"\n    Process SNS notification and send formatted message to Slack\n    \"\"\"\n    # Parse SNS message\n    sns_message = json.loads(event['Records'][0]['Sns']['Message'])\n    \n    # Get Slack webhook URL from environment (would be set in real deployment)\n    slack_webhook_url = os.environ.get('SLACK_WEBHOOK_URL', 'https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK')\n    \n    # Format Slack message\n    slack_payload = {\n        \"text\": f\"ðŸš¨ *{sns_message.get('alert', 'Error Alert')}*\",\n        \"blocks\": [\n            {\n                \"type\": \"header\",\n                \"text\": {\n                    \"type\": \"plain_text\",\n                    \"text\": f\"ðŸš¨ {sns_message.get('service', 'Service')} Alert\"\n                }\n            },\n            {\n                \"type\": \"section\",\n                \"fields\": [\n                    {\n                        \"type\": \"mrkdwn\",\n                        \"text\": f\"*Environment:*\\n{sns_message.get('environment', 'unknown')}\"\n                    },\n                    {\n                        \"type\": \"mrkdwn\", \n                        \"text\": f\"*Error:*\\n{sns_message.get('error', 'Unknown error')}\"\n                    },\n                    {\n                        \"type\": \"mrkdwn\",\n                        \"text\": f\"*Execution:*\\n{sns_message.get('executionName', 'N/A')}\"\n                    },\n                    {\n                        \"type\": \"mrkdwn\",\n                        \"text\": f\"*Timestamp:*\\n{sns_message.get('timestamp', 'N/A')}\"\n                    }\n                ]\n            },\n            {\n                \"type\": \"section\",\n                \"text\": {\n                    \"type\": \"mrkdwn\",\n                    \"text\": f\"*Error Details:*\\n```{sns_message.get('errorDetails', 'No details available')}```\"\n                }\n            },\n            {\n                \"type\": \"context\",\n                \"elements\": [\n                    {\n                        \"type\": \"mrkdwn\",\n                        \"text\": f\"Region: {sns_message.get('region', 'N/A')} | State Machine: {sns_message.get('stateMachineArn', 'N/A')}\"\n                    }\n                ]\n            }\n        ]\n    }\n    \n    # Send to Slack (in production, you'd use the actual webhook)\n    http = urllib3.PoolManager()\n    \n    try:\n        response = http.request(\n            'POST',\n            slack_webhook_url,\n            body=json.dumps(slack_payload),\n            headers={'Content-Type': 'application/json'}\n        )\n        \n        print(f\"Slack notification sent successfully. Status: {response.status}\")\n        print(f\"Payload: {json.dumps(slack_payload, indent=2)}\")\n        \n        return {\n            'statusCode': 200,\n            'body': json.dumps({\n                'message': 'Notification sent successfully',\n                'slack_response_status': response.status\n            })\n        }\n        \n    except Exception as e:\n        print(f\"Failed to send Slack notification: {str(e)}\")\n        print(f\"Would have sent: {json.dumps(slack_payload, indent=2)}\")\n        \n        return {\n            'statusCode': 500,\n            'body': json.dumps({\n                'error': 'Failed to send notification',\n                'details': str(e)\n            })\n        }\n      "},"description":"Sends formatted error notifications to Slack channel","environment":{"variables":{"SLACK_WEBHOOK_URL":"https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"}},"handler":"index.lambda_handler","role":{"Fn::GetAtt":["SlackNotificationLambdaServiceRoleA0CCE128","Arn"]},"runtime":"python3.9","timeout":30}}},"AllowInvoke:EntrixEnergyAuctionStackdevErrorNotificationTopic3DC73D50":{"id":"AllowInvoke:EntrixEnergyAuctionStackdevErrorNotificationTopic3DC73D50","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/AllowInvoke:EntrixEnergyAuctionStackdevErrorNotificationTopic3DC73D50","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["SlackNotificationLambda2FCE26D7","Arn"]},"principal":"sns.amazonaws.com","sourceArn":{"Ref":"ErrorNotificationTopic0DACB6F3"}}}},"ErrorNotificationTopic":{"id":"ErrorNotificationTopic","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/ErrorNotificationTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Subscription","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/SlackNotificationLambda/ErrorNotificationTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnSubscription","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Subscription","aws:cdk:cloudformation:props":{"endpoint":{"Fn::GetAtt":["SlackNotificationLambda2FCE26D7","Arn"]},"protocol":"lambda","topicArn":{"Ref":"ErrorNotificationTopic0DACB6F3"}}}}}}}},"EnergyAuctionApi":{"id":"EnergyAuctionApi","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"API for energy auction orders","name":"entrix-energy-auction-api-dev"}}},"Deployment":{"id":"Deployment","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"API for energy auction orders","restApiId":{"Ref":"EnergyAuctionApi74C6D117"}}}}}},"DeploymentStage.dev":{"id":"DeploymentStage.dev","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/DeploymentStage.dev","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/DeploymentStage.dev/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"EnergyAuctionApiDeploymentF954A87F63ce5fa2ba1d99d2a02ce834db60b98b"},"restApiId":{"Ref":"EnergyAuctionApi74C6D117"},"stageName":"dev"}}}}},"Endpoint":{"id":"Endpoint","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"Default":{"id":"Default","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.204.0","metadata":[]},"children":{"orders":{"id":"orders","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default/orders","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Resource","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default/orders/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["EnergyAuctionApi74C6D117","RootResourceId"]},"pathPart":"orders","restApiId":{"Ref":"EnergyAuctionApi74C6D117"}}}},"POST":{"id":"POST","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default/orders/POST","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.204.0","metadata":[]},"children":{"ApiPermission.EntrixEnergyAuctionStackdevEnergyAuctionApi1F85CCB5.POST..orders":{"id":"ApiPermission.EntrixEnergyAuctionStackdevEnergyAuctionApi1F85CCB5.POST..orders","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default/orders/POST/ApiPermission.EntrixEnergyAuctionStackdevEnergyAuctionApi1F85CCB5.POST..orders","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EntrixPostLambda9606C18F","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-west-1:844682013548:",{"Ref":"EnergyAuctionApi74C6D117"},"/",{"Ref":"EnergyAuctionApiDeploymentStagedevF5C882AC"},"/POST/orders"]]}}}},"ApiPermission.Test.EntrixEnergyAuctionStackdevEnergyAuctionApi1F85CCB5.POST..orders":{"id":"ApiPermission.Test.EntrixEnergyAuctionStackdevEnergyAuctionApi1F85CCB5.POST..orders","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default/orders/POST/ApiPermission.Test.EntrixEnergyAuctionStackdevEnergyAuctionApi1F85CCB5.POST..orders","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EntrixPostLambda9606C18F","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:aws:execute-api:eu-west-1:844682013548:",{"Ref":"EnergyAuctionApi74C6D117"},"/test-invoke-stage/POST/orders"]]}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/EnergyAuctionApi/Default/orders/POST/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"POST","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:aws:apigateway:eu-west-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["EntrixPostLambda9606C18F","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"EnergyAuctionApiorders6FDFD0A8"},"restApiId":{"Ref":"EnergyAuctionApi74C6D117"}}}}}}}}}}}},"InvokeLambdaA":{"id":"InvokeLambdaA","path":"EntrixEnergyAuctionStack-dev/InvokeLambdaA","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions_tasks.LambdaInvoke","version":"2.204.0"}},"InitializeAttempt":{"id":"InitializeAttempt","path":"EntrixEnergyAuctionStack-dev/InitializeAttempt","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Pass","version":"2.204.0"}},"IncrementAttempt":{"id":"IncrementAttempt","path":"EntrixEnergyAuctionStack-dev/IncrementAttempt","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Pass","version":"2.204.0"}},"CheckMaxRetries":{"id":"CheckMaxRetries","path":"EntrixEnergyAuctionStack-dev/CheckMaxRetries","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Choice","version":"2.204.0"}},"MaxRetriesExceeded":{"id":"MaxRetriesExceeded","path":"EntrixEnergyAuctionStack-dev/MaxRetriesExceeded","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Fail","version":"2.204.0"}},"CheckResults":{"id":"CheckResults","path":"EntrixEnergyAuctionStack-dev/CheckResults","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Choice","version":"2.204.0"}},"ProcessOrders":{"id":"ProcessOrders","path":"EntrixEnergyAuctionStack-dev/ProcessOrders","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Map","version":"2.204.0"}},"TransformForLambdaB":{"id":"TransformForLambdaB","path":"EntrixEnergyAuctionStack-dev/TransformForLambdaB","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Pass","version":"2.204.0"}},"InvokeLambdaB":{"id":"InvokeLambdaB","path":"EntrixEnergyAuctionStack-dev/InvokeLambdaB","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions_tasks.LambdaInvoke","version":"2.204.0"}},"SendErrorNotification":{"id":"SendErrorNotification","path":"EntrixEnergyAuctionStack-dev/SendErrorNotification","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions_tasks.SnsPublish","version":"2.204.0"}},"ProcessingComplete":{"id":"ProcessingComplete","path":"EntrixEnergyAuctionStack-dev/ProcessingComplete","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.Succeed","version":"2.204.0"}},"DataPipelineStateMachine":{"id":"DataPipelineStateMachine","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.StateMachine","version":"2.204.0","metadata":[]},"children":{"Role":{"id":"Role","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"states.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"lambda:InvokeFunction","Effect":"Allow","Resource":[{"Fn::GetAtt":["LambdaAE814F098","Arn"]},{"Fn::GetAtt":["LambdaB855AF8F0","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["LambdaAE814F098","Arn"]},":*"]]},{"Fn::Join":["",[{"Fn::GetAtt":["LambdaB855AF8F0","Arn"]},":*"]]}]},{"Action":"sns:Publish","Effect":"Allow","Resource":{"Ref":"ErrorNotificationTopic0DACB6F3"}}],"Version":"2012-10-17"},"policyName":"DataPipelineStateMachineRoleDefaultPolicy698F22D8","roles":[{"Ref":"DataPipelineStateMachineRoleCEB53571"}]}}}}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_stepfunctions.CfnStateMachine","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::StepFunctions::StateMachine","aws:cdk:cloudformation:props":{"definitionString":{"Fn::Join":["",["{\"StartAt\":\"InitializeAttempt\",\"States\":{\"InitializeAttempt\":{\"Type\":\"Pass\",\"Result\":{\"attempt\":1},\"ResultPath\":\"$.attempt\",\"Next\":\"InvokeLambdaA\"},\"InvokeLambdaA\":{\"Next\":\"CheckResults\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"OutputPath\":\"$.Payload\",\"Resource\":\"arn:",{"Ref":"AWS::Partition"},":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",{"Fn::GetAtt":["LambdaAE814F098","Arn"]},"\",\"Payload\":{\"attempt.$\":\"$.attempt\",\"input.$\":\"$\"}}},\"CheckResults\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.results\",\"BooleanEquals\":false,\"Next\":\"IncrementAttempt\"}],\"Default\":\"ProcessOrders\"},\"ProcessOrders\":{\"Type\":\"Map\",\"Next\":\"ProcessingComplete\",\"ItemsPath\":\"$.orders\",\"MaxConcurrency\":10,\"Iterator\":{\"StartAt\":\"TransformForLambdaB\",\"States\":{\"TransformForLambdaB\":{\"Type\":\"Pass\",\"Parameters\":{\"status.$\":\"$.order\",\"id.$\":\"$.id\",\"timestamp.$\":\"$.timestamp\",\"data.$\":\"$\"},\"Next\":\"InvokeLambdaB\"},\"InvokeLambdaB\":{\"End\":true,\"Retry\":[{\"ErrorEquals\":[\"Lambda.ClientExecutionTimeoutException\",\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Catch\":[{\"ErrorEquals\":[\"States.TaskFailed\"],\"ResultPath\":\"$.error\",\"Next\":\"SendErrorNotification\"}],\"Type\":\"Task\",\"InputPath\":\"$\",\"ResultPath\":\"$.result\",\"Resource\":\"arn:",{"Ref":"AWS::Partition"},":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",{"Fn::GetAtt":["LambdaB855AF8F0","Arn"]},"\",\"Payload.$\":\"$\"}},\"SendErrorNotification\":{\"End\":true,\"Type\":\"Task\",\"Resource\":\"arn:",{"Ref":"AWS::Partition"},":states:::sns:publish\",\"Parameters\":{\"TopicArn\":\"",{"Ref":"ErrorNotificationTopic0DACB6F3"},"\",\"Message\":{\"alert\":\"ðŸš¨ Lambda B Error\",\"environment\":\"dev\",\"service\":\"Energy Auction Processing\",\"error\":\"Lambda B failed to process order\",\"errorDetails.$\":\"$.error.Error\",\"failedOrder.$\":\"$.data\",\"executionName.$\":\"$$.Execution.Name\",\"timestamp.$\":\"$$.State.EnteredTime\",\"stateMachineArn.$\":\"$$.StateMachine.Name\",\"region\":\"eu-west-1\"},\"Subject\":\"ðŸš¨ Lambda B Processing Error\"}}}}},\"ProcessingComplete\":{\"Type\":\"Succeed\"},\"IncrementAttempt\":{\"Type\":\"Pass\",\"Parameters\":{\"attempt.$\":\"States.MathAdd($.attempt, 1)\",\"input.$\":\"$\"},\"Next\":\"CheckMaxRetries\"},\"CheckMaxRetries\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.attempt\",\"NumericGreaterThan\":5,\"Next\":\"MaxRetriesExceeded\"}],\"Default\":\"InvokeLambdaA\"},\"MaxRetriesExceeded\":{\"Type\":\"Fail\",\"Error\":\"LambdaAMaxRetries\",\"Cause\":\"Lambda A failed to return true results after 5 attempts\"}},\"TimeoutSeconds\":900}"]]},"roleArn":{"Fn::GetAtt":["DataPipelineStateMachineRoleCEB53571","Arn"]},"stateMachineName":"entrix-data-pipeline-dev"}}},"EventsRole":{"id":"EventsRole","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/EventsRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportEventsRole":{"id":"ImportEventsRole","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/EventsRole/ImportEventsRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/EventsRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"events.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/EventsRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/DataPipelineStateMachine/EventsRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"states:StartExecution","Effect":"Allow","Resource":{"Ref":"DataPipelineStateMachineA0BAC8C1"}}],"Version":"2012-10-17"},"policyName":"DataPipelineStateMachineEventsRoleDefaultPolicy1D74FEDB","roles":[{"Ref":"DataPipelineStateMachineEventsRoleC7573D65"}]}}}}}}}}},"DataPipelineSchedule":{"id":"DataPipelineSchedule","path":"EntrixEnergyAuctionStack-dev/DataPipelineSchedule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/DataPipelineSchedule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"name":"data-pipeline-schedule-dev","scheduleExpression":"rate(1 hour)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Ref":"DataPipelineStateMachineA0BAC8C1"},"roleArn":{"Fn::GetAtt":["DataPipelineStateMachineEventsRoleC7573D65","Arn"]}}]}}}}},"BuildProject":{"id":"BuildProject","path":"EntrixEnergyAuctionStack-dev/BuildProject","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.PipelineProject","version":"2.204.0","metadata":[]},"children":{"Role":{"id":"Role","path":"EntrixEnergyAuctionStack-dev/BuildProject/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"EntrixEnergyAuctionStack-dev/BuildProject/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/BuildProject/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/BuildProject/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/BuildProject/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:aws:logs:eu-west-1:844682013548:log-group:/aws/codebuild/",{"Ref":"BuildProject097C5DB7"},":*"]]},{"Fn::Join":["",["arn:aws:logs:eu-west-1:844682013548:log-group:/aws/codebuild/",{"Ref":"BuildProject097C5DB7"}]]}]},{"Action":["codebuild:BatchPutCodeCoverages","codebuild:BatchPutTestCases","codebuild:CreateReport","codebuild:CreateReportGroup","codebuild:UpdateReport"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:aws:codebuild:eu-west-1:844682013548:report-group/",{"Ref":"BuildProject097C5DB7"},"-*"]]}},{"Action":"*","Effect":"Allow","Resource":"*"},{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},"/*"]]}]},{"Action":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]}}],"Version":"2012-10-17"},"policyName":"BuildProjectRoleDefaultPolicy3E9F248C","roles":[{"Ref":"BuildProjectRoleAA92C755"}]}}}}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/BuildProject/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"CODEPIPELINE"},"cache":{"type":"NO_CACHE"},"encryptionKey":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]},"environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:5.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":false,"computeType":"BUILD_GENERAL1_SMALL"},"name":"energy-auction-build-dev","serviceRole":{"Fn::GetAtt":["BuildProjectRoleAA92C755","Arn"]},"source":{"type":"CODEPIPELINE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"install\": {\n      \"runtime-versions\": {\n        \"nodejs\": \"18\"\n      },\n      \"commands\": [\n        \"npm install -g aws-cdk\",\n        \"npm ci\"\n      ]\n    },\n    \"pre_build\": {\n      \"commands\": [\n        \"cdk synth\"\n      ]\n    },\n    \"build\": {\n      \"commands\": [\n        \"cdk deploy --require-approval never\"\n      ]\n    }\n  }\n}"}}}}}},"Pipeline":{"id":"Pipeline","path":"EntrixEnergyAuctionStack-dev/Pipeline","constructInfo":{"fqn":"aws-cdk-lib.aws_codepipeline.Pipeline","version":"2.204.0","metadata":[]},"children":{"ArtifactsBucketEncryptionKey":{"id":"ArtifactsBucketEncryptionKey","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucketEncryptionKey","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Key","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucketEncryptionKey/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnKey","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Key","aws:cdk:cloudformation:props":{"keyPolicy":{"Statement":[{"Action":"kms:*","Effect":"Allow","Principal":{"AWS":"arn:aws:iam::844682013548:root"},"Resource":"*"}],"Version":"2012-10-17"}}}}}},"ArtifactsBucketEncryptionKeyAlias":{"id":"ArtifactsBucketEncryptionKeyAlias","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucketEncryptionKeyAlias","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.Alias","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucketEncryptionKeyAlias/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_kms.CfnAlias","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::KMS::Alias","aws:cdk:cloudformation:props":{"aliasName":"alias/codepipeline-entrixenergyauctionstack-dev-pipeline-f2686bc6","targetKeyId":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]}}}}}},"ArtifactsBucket":{"id":"ArtifactsBucket","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"aws:kms","kmsMasterKeyId":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]}}}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true}}}},"Policy":{"id":"Policy","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/ArtifactsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"PipelineArtifactsBucket22248F97"},"policyDocument":{"Statement":[{"Action":"s3:*","Condition":{"Bool":{"aws:SecureTransport":"false"}},"Effect":"Deny","Principal":{"AWS":"*"},"Resource":[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}}}},"Role":{"id":"Role","path":"EntrixEnergyAuctionStack-dev/Pipeline/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"EntrixEnergyAuctionStack-dev/Pipeline/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codepipeline.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/Pipeline/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},"/*"]]}]},{"Action":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]}},{"Action":"sts:AssumeRole","Effect":"Allow","Resource":[{"Fn::GetAtt":["PipelineBuildCodeBuildCodePipelineActionRoleEE1A2CE7","Arn"]},{"Fn::GetAtt":["PipelineSourceGitHubSourceCodePipelineActionRole3B2287CE","Arn"]}]}],"Version":"2012-10-17"},"policyName":"PipelineRoleDefaultPolicyC7A05455","roles":[{"Ref":"PipelineRoleD68726F7"}]}}}}}}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codepipeline.CfnPipeline","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodePipeline::Pipeline","aws:cdk:cloudformation:props":{"artifactStore":{"type":"S3","location":{"Ref":"PipelineArtifactsBucket22248F97"},"encryptionKey":{"type":"KMS","id":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]}}},"name":"entrix-energy-auction-pipeline-dev","roleArn":{"Fn::GetAtt":["PipelineRoleD68726F7","Arn"]},"stages":[{"name":"Source","actions":[{"name":"GitHub_Source","outputArtifacts":[{"name":"Artifact_Source_GitHub_Source"}],"actionTypeId":{"category":"Source","version":"1","owner":"AWS","provider":"CodeStarSourceConnection"},"configuration":{"ConnectionArn":"arn:aws:codeconnections:eu-west-1:844682013548:connection/2bdacb93-aec6-4509-b83f-5cb0aa78c25a","FullRepositoryId":"devd-s/entrix-task","BranchName":"master"},"runOrder":1,"roleArn":{"Fn::GetAtt":["PipelineSourceGitHubSourceCodePipelineActionRole3B2287CE","Arn"]}}]},{"name":"Build","actions":[{"name":"CodeBuild","inputArtifacts":[{"name":"Artifact_Source_GitHub_Source"}],"outputArtifacts":[{"name":"Artifact_Build_CodeBuild"}],"actionTypeId":{"category":"Build","version":"1","owner":"AWS","provider":"CodeBuild"},"configuration":{"ProjectName":{"Ref":"BuildProject097C5DB7"}},"runOrder":1,"roleArn":{"Fn::GetAtt":["PipelineBuildCodeBuildCodePipelineActionRoleEE1A2CE7","Arn"]}}]}]}}},"Source":{"id":"Source","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"GitHub_Source":{"id":"GitHub_Source","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source/GitHub_Source","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CodePipelineActionRole":{"id":"CodePipelineActionRole","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source/GitHub_Source/CodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportCodePipelineActionRole":{"id":"ImportCodePipelineActionRole","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source/GitHub_Source/CodePipelineActionRole/ImportCodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source/GitHub_Source/CodePipelineActionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["PipelineRoleD68726F7","Arn"]}}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source/GitHub_Source/CodePipelineActionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Source/GitHub_Source/CodePipelineActionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"codestar-connections:UseConnection","Effect":"Allow","Resource":"arn:aws:codeconnections:eu-west-1:844682013548:connection/2bdacb93-aec6-4509-b83f-5cb0aa78c25a"},{"Action":["s3:Abort*","s3:DeleteObject*","s3:GetBucket*","s3:GetObject*","s3:List*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},"/*"]]}]},{"Action":["kms:Decrypt","kms:DescribeKey","kms:Encrypt","kms:GenerateDataKey*","kms:ReEncrypt*"],"Effect":"Allow","Resource":{"Fn::GetAtt":["PipelineArtifactsBucketEncryptionKey01D58D69","Arn"]}},{"Action":["s3:PutObjectAcl","s3:PutObjectVersionAcl"],"Effect":"Allow","Resource":{"Fn::Join":["",[{"Fn::GetAtt":["PipelineArtifactsBucket22248F97","Arn"]},"/*"]]}}],"Version":"2012-10-17"},"policyName":"PipelineSourceGitHubSourceCodePipelineActionRoleDefaultPolicyE64B1C38","roles":[{"Ref":"PipelineSourceGitHubSourceCodePipelineActionRole3B2287CE"}]}}}}}}}}}}},"Build":{"id":"Build","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CodeBuild":{"id":"CodeBuild","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build/CodeBuild","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CodePipelineActionRole":{"id":"CodePipelineActionRole","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build/CodeBuild/CodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.204.0","metadata":[]},"children":{"ImportCodePipelineActionRole":{"id":"ImportCodePipelineActionRole","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build/CodeBuild/CodePipelineActionRole/ImportCodePipelineActionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.204.0","metadata":[]}},"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build/CodeBuild/CodePipelineActionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["PipelineRoleD68726F7","Arn"]}}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build/CodeBuild/CodePipelineActionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.204.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"EntrixEnergyAuctionStack-dev/Pipeline/Build/CodeBuild/CodePipelineActionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.204.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["codebuild:BatchGetBuilds","codebuild:StartBuild","codebuild:StopBuild"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BuildProject097C5DB7","Arn"]}}],"Version":"2012-10-17"},"policyName":"PipelineBuildCodeBuildCodePipelineActionRoleDefaultPolicyD9C4A2F6","roles":[{"Ref":"PipelineBuildCodeBuildCodePipelineActionRoleEE1A2CE7"}]}}}}}}}}}}}}},"ApiEndpoint":{"id":"ApiEndpoint","path":"EntrixEnergyAuctionStack-dev/ApiEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"OrderResultsBucketName":{"id":"OrderResultsBucketName","path":"EntrixEnergyAuctionStack-dev/OrderResultsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"OrdersTableName":{"id":"OrdersTableName","path":"EntrixEnergyAuctionStack-dev/OrdersTableName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"StateMachineArn":{"id":"StateMachineArn","path":"EntrixEnergyAuctionStack-dev/StateMachineArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"PipelineName":{"id":"PipelineName","path":"EntrixEnergyAuctionStack-dev/PipelineName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"BuildProjectName":{"id":"BuildProjectName","path":"EntrixEnergyAuctionStack-dev/BuildProjectName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"GitHubConnectionInfo":{"id":"GitHubConnectionInfo","path":"EntrixEnergyAuctionStack-dev/GitHubConnectionInfo","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.204.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"EntrixEnergyAuctionStack-dev/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"EntrixEnergyAuctionStack-dev/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.204.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"EntrixEnergyAuctionStack-dev/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.204.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"EntrixEnergyAuctionStack-dev/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.204.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}